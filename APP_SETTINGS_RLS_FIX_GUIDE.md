# ๐ง ุฅุตูุงุญ ูุดููุฉ RLS ูู App Settings

## ๐จ ุงููุดููุฉ
ุนูุฏ ุงูุถุบุท ุนูู "Save Engine Setting" ูู ุตูุญุฉ ุงูุฅุฏุงุฑุฉุ ูุธูุฑ ุฎุทุฃ:
```
new row violates row-level security policy for table "app_settings"
```

## ๐๏ธ ุงูุญู ุงูุณุฑูุน

### ุงูุฎุทูุฉ 1: ุชูููุฐ SQL ุงูุฅุตูุงุญ

1. ุงุฐูุจ ุฅูู [Supabase Dashboard](https://supabase.com/dashboard)
2. ุงุฎุชุฑ ูุดุฑูุนู
3. ุงุฐูุจ ุฅูู **SQL Editor**
4. ุงูุณุฎ ูุญุชูู ููู `fix_app_settings_rls.sql`
5. ุงุถุบุท **Run**

### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุงูุฅุตูุงุญ

ุจุนุฏ ุชูููุฐ SQLุ ูุฌุจ ุฃู ุชุฑู:
- โ ุฑุณุงูุฉ "Success"
- โ ุฌุฏูู ูุญุชูู ุนูู ุฅุนุฏุงุฏ `transcription_engine`
- โ ุณูุงุณุงุช RLS ุฌุฏูุฏุฉ

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ

```bash
# ุชุดุบูู ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ
node test_app_settings_fix.js
```

## ๐ ูุง ููุนูู ุงูุฅุตูุงุญ

### 1. ุญุฐู ุงูุณูุงุณุงุช ุงููุฏููุฉ
- ูุญุฐู ุฌููุน ุณูุงุณุงุช RLS ุงููุฏููุฉ ุนูู `app_settings`
- ูุจุฏุฃ ูู ุฌุฏูุฏ ูุชุฌูุจ ุงูุชุนุงุฑุถุงุช

### 2. ุฅูุดุงุก ุณูุงุณุงุช ุฌุฏูุฏุฉ
- **ุณูุงุณุฉ ุงููุฑุงุกุฉ**: ุฌููุน ุงููุณุชุฎุฏููู ุงููุตุงุฏู ุนูููู ูููููู ุงููุฑุงุกุฉ
- **ุณูุงุณุฉ ุงููุชุงุจุฉ**: ููุท superadmins ูููููู ุงููุชุงุจุฉ

### 3. ุฅุถุงูุฉ ุงูุฅุนุฏุงุฏ ุงูููููุฏ
- ูุถูู `transcription_engine` ุฅุฐุง ูู ููู ููุฌูุฏุงู
- ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ: `azure`

## ๐ ุงูุชุญูู ูู ุงูุฅุตูุงุญ

### ูู ุงูุชุทุจูู:
1. ุงุฐูุจ ุฅูู ุตูุญุฉ ุงูุฅุฏุงุฑุฉ
2. ุงุฎุชุฑ ุชุจููุจ "Settings"
3. ุฌุฑุจ ุงูุชุจุฏูู ุจูู Azure ู Faster Whisper
4. ุงุถุบุท "Save Engine Setting"
5. ูุฌุจ ุฃู ูุนูู ุจุฏูู ุฃุฎุทุงุก

### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```sql
-- ุงูุชุญูู ูู ูุฌูุฏ ุงูุฅุนุฏุงุฏ
SELECT * FROM app_settings WHERE key = 'transcription_engine';

-- ุงูุชุญูู ูู ุงูุณูุงุณุงุช
SELECT schemaname, tablename, policyname, permissive, roles, cmd, qual 
FROM pg_policies 
WHERE tablename = 'app_settings';
```

## ๐จ ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ

### ุงูุฎูุงุฑ 1: ุชุนุทูู RLS ูุคูุชุงู
```sql
-- ูู Supabase SQL Editor
ALTER TABLE app_settings DISABLE ROW LEVEL SECURITY;
```

### ุงูุฎูุงุฑ 2: ุฅุถุงูุฉ ุณูุงุณุฉ ุนุงูุฉ
```sql
-- ูู Supabase SQL Editor
CREATE POLICY "Allow all access to app_settings"
  ON app_settings
  FOR ALL
  TO authenticated
  USING (true)
  WITH CHECK (true);
```

## ๐ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชุทุจูู ุงูุฅุตูุงุญ:
- โ ุฒุฑ "Save Engine Setting" ูุนูู ุจุฏูู ุฃุฎุทุงุก
- โ ูููู ุงูุชุจุฏูู ุจูู Azure ู Faster Whisper
- โ ุงูุฅุนุฏุงุฏุงุช ุชูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ูุคุดุฑ ุงูุญุงูุฉ ูุนูู ุจุดูู ุตุญูุญ

## ๐ ุงูุฃูุงู

ุงูุฅุตูุงุญ ูุญุงูุธ ุนูู ุงูุฃูุงู:
- **ุงููุฑุงุกุฉ**: ูุชุงุญุฉ ูุฌููุน ุงููุณุชุฎุฏููู ุงููุตุงุฏู ุนูููู
- **ุงููุชุงุจุฉ**: ูุชุงุญุฉ ููุท ูู superadmins
- **ุงูุชุญูู**: ูุชู ุงูุชุญูู ูู ุฏูุฑ ุงููุณุชุฎุฏู ูุจู ุงูุณูุงุญ ุจุงููุชุงุจุฉ 