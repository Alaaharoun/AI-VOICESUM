# إصلاح مشكلة صفحة الاشتراكات

## المشكلة:
صفحة الاشتراكات لا تفتح وتظهر خطأ 406 (Not Acceptable) عند محاولة الوصول إلى جدول `app_settings`.

## السبب:
جدول `app_settings` غير موجود في قاعدة البيانات، مما يسبب فشل الطلبات.

## الحل:

### 1. إنشاء جدول app_settings في Supabase:

1. اذهب إلى [Supabase Dashboard](https://supabase.com/dashboard)
2. اختر مشروعك
3. اذهب إلى **SQL Editor**
4. انسخ محتوى ملف `create_app_settings_table.sql` والصقه في المحرر
5. اضغط **Run** لتنفيذ الكود

### 2. التغييرات التي تمت في الكود:

#### أ. إصلاح متغير FAQ المفقود:
- تم استبدال متغير `FAQ` غير المعرف بأسئلة وأجوبة ثابتة
- تم إضافة 4 أسئلة شائعة مع إجاباتها

#### ب. تحسين التعامل مع packageData:
- تم إضافة فحص أفضل لوجود البيانات
- تم إصلاح أخطاء في عرض خطط الاشتراك

#### ج. إصلاح أخطاء القوس:
- تم إصلاح خطأ في إغلاق القوس في map function

### 3. اختبار الإصلاح:

1. أعد تشغيل التطبيق:
```bash
npx expo start
```

2. اذهب إلى صفحة الاشتراكات
3. تأكد من أن الصفحة تفتح بدون أخطاء

### 4. الملفات المعدلة:

- `app/subscription.tsx` - إصلاح أخطاء الكود
- `create_app_settings_table.sql` - إنشاء جدول app_settings
- `supabase/migrations/20250705030000_create_app_settings_table.sql` - ملف الهجرة

### 5. ملاحظات مهمة:

- تأكد من تنفيذ SQL في Supabase Dashboard
- إذا استمرت المشكلة، تحقق من إعدادات RLS (Row Level Security)
- تأكد من أن المستخدم لديه صلاحيات للوصول إلى الجدول

### 6. للتحقق من الإصلاح:

افتح Developer Console في المتصفح وتأكد من عدم وجود أخطاء 406 عند تحميل صفحة الاشتراكات. 